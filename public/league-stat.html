<!DOCTYPE html>
<!-- nav bar: Projects, about -->
<!-- body: game stat tracker. -->
<html>
  <head>
    <meta charset="UTF-8" />
    <title>League Stats</title>
    <link
      href="https://fonts.googleapis.com/css?family=Lato"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="stylesheets/styles.css" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="/socket.io/socket.io.js" type="text/javascript"></script>
    <script>
      var socket = io.connect();

      $(document).ready(() => {
        let playerName = "makinghandties";
        socket.on("ready", (data) => {
          console.log("Ready!");
        });

        socket.emit("getPlayer", playerName);
        socket.on("getPlayer", (data) => {
          console.log("Player!");
          console.log(data);
          $("#playerName").text(data);

          socket.emit("getMatches");
          socket.on("getMatches", (data) => {
            console.log(data);
            let matches = data;
            console.log("Endindex " + matches.endIndex);
            let numberOfmatches = 20 < matches.endIndex ? 20 : matches.endIndex;
            for (let i = 0; i < numberOfmatches; i++) {
              $("#main").append(matchFactory(i));
            }
          });

          socket.emit("getRankingData");
          socket.on("getRankingData", (data) => {
            console.log(data);
          });
        });
      });

      function matchFactory(i) {
        // Champ icon
        let $champIcon = $("<div>")
          .append(
            $("<img>")
              .addClass("champ-icon rounded-circle")
              .attr("src", "resources/irelia.jpg")
          )
          .append(
            $('<p style="text-align: center; margin-top: 5px;"">').text(
              "Irelia"
            )
          );

        let $Result = $("<div>")
          .addClass("container-inline ml-5 vertical-middle")
          .append($("<h1>").text("Victory"))
          .append($("<hr>").addClass("my-2"))
          .append($("<h5>").text("Ranked Solo/Duo"))
          .append($("<h5>").text("32 min"));

        let $KDA = $("<div>")
          .addClass(
            "container-inline ml-5 vertical-middle justify-content-center"
          )
          .append($("<h2>").text("0 / 0 / 0"))
          .append(
            $("<div>")
              .addClass("container justify-content-center")
              .append(
                $("<img>").attr("src", "resources/flash.jpg").width("30px")
              )
              .append(
                $("<img>").attr("src", "resources/ignite.jpg").width("30px")
              )
          );

        let $Stats = $("<div>")
          .addClass("container-inline ml-5 vertical-middle")
          .append("<h5>CS: 231 (6.4)</h5>")
          .append("<h5>KP: 31%</h5>")
          .append("<h5>DShare: 41%</h5>")
          .append("<h5>DPS: 41%</h5>");

        return $("<div></div>")
          .addClass(
            "match-container d-flex flex-row shadow-noshadow p-3 bg-primary rounded"
          )
          .append($champIcon)
          .append($Result)
          .append($KDA)
          .append($Stats);
      }
    </script>
    <script>
      $(document).ready(function () {
        createHistory();
      });
      function createHistory() {
        let $main = $("#main");
        $main.append("<p>Hello!</p>");
      }
    </script>
    <style>
      .vertical-middle {
        margin-top: auto;
        margin-bottom: auto;
      }
      .player-container {
        width: 1200px;
        height: 500px;
        margin-top: 10px;
      }
      .match-container {
        width: 1000px;
        height: 150px;
        margin-left: auto;
        margin-right: auto;
        margin-bottom: 5px;
        margin-top: 5px;
      }
      .champ-icon {
        width: 100px;
        height: 100px;
      }
    </style>
  </head>

  <body>
    <!-- Nav Bar -->
    <nav class="navbar navbar-expand-sm bg-light justify-content-center">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="league-stat.html">League Stats</a>
        </li>
      </ul>
    </nav>

    <!-- Banner -->
    <div class="container-fluid player-container" style="text-align: center">
      <div id="main" class="jumbotron">
        <image
          src="resources/irelia.jpg"
          alt="Irelia"
          class="champ-icon rounded-circle"
        />
        <h1 id="playerName" class="display-4"></h1>
        <p class="lead">Plat 4, 52% winrate</p>

        <hr class="my-4" />
        <p>Recent games stats</p>
        <p class="lead">
          <button
            class="btn btn-primary"
            type="button"
            data-toggle="collapse"
            data-target="#collapseExample"
            aria-expanded="false"
            aria-controls="collapseExample"
          >
            More Stats!
          </button>
        </p>

        <!-- Stats Collapse -->
        <div class="collapse show" id="collapseExample">
          <div class="card card-body">STATS!</div>
        </div>

        <!-- Match container-->
        <div
          class="match-container d-flex flex-row shadow-noshadow p-3 bg-primary rounded"
        >
          <div class="container-inline">
            <image
              src="resources/irelia.jpg"
              alt="Irelia"
              class="champ-icon rounded-circle"
            />
            <p style="text-align: center; margin-top: 5px">Irelia</p>
          </div>

          <!-- Type/Result -->
          <div class="container-inline ml-5 vertical-middle">
            <h1>Victory</h1>
            <hr class="my-2" />
            <h5>Ranked Solo/Duo</h5>
            <h5>32 min</h5>
          </div>
          <!-- KDA -->
          <div
            class="container-inline ml-5 vertical-middle justify-content-center"
          >
            <h2>0 / 0 / 0</h2>
            <div class="container justify-content-center">
              <image src="resources/flash.jpg" width="30px"></image>
              <image src="resources/ignite.jpg" width="30px"></image>
            </div>
          </div>
          <!-- Quick stats -->
          <div class="container-inline ml-5 vertical-middle">
            <h5>CS: 231 (6.4)</h5>
            <h5>KP: 31%</h5>
            <h5>DShare: 41%</h5>
            <h5>DPS: 41%</h5>
          </div>
          <!-- Build and opponents -->
          <div class="container-inline">
            <p style="text-align: center">TBD</p>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
